<html xmlns:fb="http://www.facebook.com/2008/fbml">
<head>
<title>Facebook Spectrum</title>

<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script src="http://static.simile.mit.edu/timeline/api-2.3.0/timeline-api.js?bundle=true" type="text/javascript"></script>

<!--
<script type="text/javascript" src="yearview.js"></script>
<script type="text/javascript" src="visualization.js"></script>
<script type="text/javascript" src="timeline.js"></script>
<script type="text/javascript" src="compact-painter2.js"></script>
<script type="text/javascript" src="UProgressBar.js"></script>
<script type="text/javascript" src="wordcumulus.js"></script>
<script type="text/javascript" src="swfobject.js"></script>
<script type="text/javascript" src="spectrum.js"></script>
<script type="text/javascript" src="search.js"></script>
<script type="text/javascript" src="activity.js"></script>
<script type="text/javascript" src="export.js"></script>
-->
<link rel="shortcut icon" href="/svn/trunk/favicon.ico" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="spectrum.css">
<script type="text/javascript">
	google.load("visualization", "1", {packages:["corechart"]});
	google.load("visualization", "1", {packages:["table"]});
	google.load("visualization", "1");
	google.load("jquery", "1.4.4");
	google.load("search", "1");
</script>
<script type="text/javascript" src="highcharts.js"></script>

<!--
<script type="text/javascript" src="highchartsoptions.js"></script>
-->

<script type="text/javascript" src="closure.js?v=110411"></script>

<script language="Javascript">

	function switchTab(tab) {
		log('switchTab called for '+tab);
		window.location.hash = tab;

		$('.tab').each(function(index) {
			$(this).removeClass('selected');
			if($(this).text().toLowerCase()==tab)
				$(this).addClass('selected');
		});

		if(userLoggedIn) {
			$('.block').each(function(index) {
				$(this).removeClass('show');
				$(this).addClass('hide');
				if($(this).attr('id')==tab+'Block') {
					$(this).removeClass('hide');
					$(this).addClass('show');
				}
			});


			if(tab=='home') {

			} else if(tab=='friends') {
				displayFriendSphere();
			} else if(tab=='timeline') {
				displayTimeline();
			} else if(tab=='birthday') {
				displayBirthdayInfo();
			} else if(tab=='location') {
				displayLocationInfo();
			} else if(tab=='albums') {
				displayAlbumInfo();
			} else if(tab=='mutuals') {
				displayMutualFriendInfo();
				displayMutualLikesInfo();
			} else if(tab=='other') {
				drawGenderChart();
				drawEducationChart();
			} else if(tab=='search') {
				//anything specific to search?
			} else if(tab=='activity') {
				captureActivityMetrics();
				//displayActivityChart();
			} else if(tab=='download') {

			} else if(tab=='more') {

			} else {
				//This might be FAQ page
			}
		} else {
			if(tab=='faq' || tab=='home' || tab=='search') {
				$('.block').each(function(index) {
					$(this).removeClass('show');
					$(this).addClass('hide');
				});

				$('#'+tab+'Block').removeClass('hide');
				$('#'+tab+'Block').addClass('show');
			}
		}

	}

	var lastHash = '';
	function pollHash() {
	    if(lastHash !== location.hash) {
	        lastHash = location.hash;
	        // hash has changed, load the content:
	        //alert(lastHash);
	        switchTab(lastHash.substring(1));
	    }
	}
	//Poll for back button changes
	setInterval(pollHash, 100);


	function showLoadingMessage(){
		var maskHeight = $(document).height();
	    var maskWidth = $(document).width();
	    $('#mask').css({'top':0, 'left':0, 'width':maskWidth,'height':maskHeight});
	    var winH = $(window).height();
        var winW = $(window).width();
        //Center the popup window to center the window
        $('#lightbox-panel').css('top',  winH/2-$('#lightbox-panel').height()/2);
        $('#lightbox-panel').css('left', winW/2-$('#lightbox-panel').width()/2);

		$("#mask, #lightbox-panel").fadeIn(300);
	}

	function checkContentsLoaded() {
		if(AlbumsLoaded) {
			hideLoadingMessage();
		} else {
			window.setTimeout("checkContentsLoaded();", 500);
		}
	}

	function startLoadingContents() {
		showLoadingMessage();
		userGreeting();
		loadProfileData();
		checkContentsLoaded();
	}

	function hideLoadingMessage(){
	 	$("#mask, #lightbox-panel").fadeOut(300);
	}

	function displayRefreshText() {
		$("#mask, #lightbox-panel").append('Oops.. Something went wrong. Please <a href="javascript:window.location.reload()">refresh</a> the page');
	}

	window.setTimeout('displayRefreshText()', 30000);

</script>

</head>
<body>

<div id="lightbox-panel">
	<img src="ajax-loader.gif" align="left" style="margin-top:12px;margin-right:15px;vertical-align:text-top"><h2>Loading, Please wait...</h2>
</div>
<div id="mask"></div>

<table width="100%" cellpadding="0" cellspacing="0">
	<tr>
		<td width="50%">&nbsp;</td>
			<td width="400" align="right" style="width:400px;padding-right:25px">
				<fb:login-button autologoutlink="true" scope="friends_photos,friends_location,friends_birthday,read_stream,friends_education_history,user_likes"></fb:login-button>
			</td>
		</tr>
</table>
<div class="heading">
	<div style="height:105px;position:relative">
		<img src="chart.png" style="margin-left:20px" width="50" height="50">&nbsp; <span style="color:#111111;position:absolute;font-size:14px;bottom:15px;left:130px;">Facebook Spectrum</span>
	</div>
</div>


<table width="100%" height="100%" cellpadding="0" cellspacing="0">
	<tr>
		<td width="90%" valign="top" style="padding:10px;border-right:4px solid #FFFFFF">
			<div class="block show" id="searchBlock">
				<!--searchBlock-->
				<div style="margin:20px">
					If you want to know what people are posting on Facebook at this moment, type your search query and hit Enter.
					<br>
					<b>Looking for </b>: <input type="text" class="searchBox" id="searchStr" value="cricket"> <input type="button" class="searchButton" value="Search" onclick="searchFacebook();"><br>
					<div id="searchResults">
						<div class="item"></div>
						<div class="item"></div>
						<div class="item"></div>
						<div class="item"></div>
						<div class="item"></div>
						<div class="item"></div>
						<div class="item"></div>
						<div class="item"></div>
						<div class="item"></div>
						<div class="item"></div>
					</div>
				</div>

			</div>
		</td>
	</tr>
</table>

<div class="footer">[Facebook Spectrum is not affiliated with Facebook]</div>

<div style="display:none">
<span>Debug Log:</span><a href="javascript:void(0);" onclick="document.getElementById('debugLog').innerHTML='';">Clear</a>
<div id="debugLog" style="width:600px;height:100px;overflow:scroll;border:2px solid#638254;display:none"></div>
</div>

<div id="fb-root"></div>
	<script type="text/javascript">
		<!--
		window.fbAsyncInit = function() {
			var friendId = 0;
			FB.init({appId: '132839880113484', status: true, cookie: true,
					 xfbml: true});

			FB.getLoginStatus(function(response) {
				//alert('FB.getLoginStatus = '+response.session+' - '+response.status+' - '+response.perms);
				if (response.authResponse.accessToken) {
					// logged in and connected user, someone you know
					//alert('getLoginStatus '+response.session);
					if(!userLoggedIn) {
						userLoggedIn = true;
						startLoadingContents();
					}
				} else {
				    // no user session available, someone you dont know
				}
			});

			FB.Event.subscribe('auth.sessionChange', function(response) {
				if (response.authResponse.accessToken) {
					// A user has logged in, and a new cookie has been saved
					//alert('sessionChange '+response.session);
					if(!userLoggedIn) {
						userLoggedIn = true;
						startLoadingContents();
					}
				    //window.location.reload();
				    //reload window upon login and set session
				} else {
					// The user has logged out, and the cookie has been cleared
					//alert('user logged out..');
				    window.location.reload();
				    //reload the page and clear the cookie
				}
			});

		};
		-->
		(function() {
			var e = document.createElement('script');
			e.type = 'text/javascript';
			e.src = document.location.protocol +'//connect.facebook.net/en_US/all.js';
			e.async = true;
			document.getElementById('fb-root').appendChild(e);
		}());


	</script>

	<!-- Google Analytics -->
	<script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-1214589-24']);
	  _gaq.push(['_trackPageview']);

	  (function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>

</body>
</html>